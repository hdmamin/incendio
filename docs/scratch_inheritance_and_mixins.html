---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/scratch_inheritance_and_mixins.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">type_info</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">type_</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Preprocessor</span><span class="p">,</span> <span class="n">FeatureScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">type_</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Preprocessor</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Preprocessor()&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pre</span> <span class="o">=</span> <span class="n">Preprocessor</span><span class="p">()</span>
<span class="n">pre</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>forward
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">type_info</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;__main__.Preprocessor&#39;&gt;
&lt;class &#39;__main__.Preprocessor&#39;&gt; True
&lt;class &#39;__main__.FeatureScaler&#39;&gt; False
&lt;class &#39;__main__.MinMaxScaler&#39;&gt; False
Preprocessor()
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">FeatureScaler</span><span class="p">(</span><span class="n">Preprocessor</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processed</span> <span class="o">=</span> <span class="kc">False</span>
        
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;processing&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processed</span> <span class="o">=</span> <span class="kc">True</span>
        
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">FeatureScaler</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>forward
processing
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">type_info</span><span class="p">(</span><span class="n">scaler</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;__main__.FeatureScaler&#39;&gt;
&lt;class &#39;__main__.Preprocessor&#39;&gt; True
&lt;class &#39;__main__.FeatureScaler&#39;&gt; True
&lt;class &#39;__main__.MinMaxScaler&#39;&gt; False
Preprocessor()
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">scaler2</span> <span class="o">=</span> <span class="n">FeatureScaler</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">scaler2</span><span class="o">.</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[1, 2]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MinMaxScaler</span><span class="p">(</span><span class="n">FeatureScaler</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">arg</span><span class="o">/</span><span class="mi">2</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minmax</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">minmax</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="n">minmax</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">minmax</span><span class="o">.</span><span class="n">scale</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>forward
processing
[0.5, 1.0, 1.5]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">type_info</span><span class="p">(</span><span class="n">minmax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;__main__.MinMaxScaler&#39;&gt;
&lt;class &#39;__main__.Preprocessor&#39;&gt; True
&lt;class &#39;__main__.FeatureScaler&#39;&gt; True
&lt;class &#39;__main__.MinMaxScaler&#39;&gt; True
Preprocessor()
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minmax2</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">minmax2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">minmax2</span><span class="o">.</span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(7, 8)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">StandardScaler</span><span class="p">(</span><span class="n">FeatureScaler</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>
        
    <span class="k">def</span> <span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="n">ss</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ss</span><span class="o">.</span><span class="n">backward</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>forward
(33, 22, 11)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ss2</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">ss2</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ss2</span><span class="o">.</span><span class="n">backward</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>forward
(11, 9, 7)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">type_info</span><span class="p">(</span><span class="n">ss2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;__main__.StandardScaler&#39;&gt;
&lt;class &#39;__main__.Preprocessor&#39;&gt; True
&lt;class &#39;__main__.FeatureScaler&#39;&gt; True
&lt;class &#39;__main__.MinMaxScaler&#39;&gt; False
Preprocessor()
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TmpModule</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">init_args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__class__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_args</span> <span class="o">=</span> <span class="n">init_args</span>
        
    <span class="k">def</span> <span class="nf">get_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;init args:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_args</span><span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">arr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ImgModel</span><span class="p">(</span><span class="n">TmpModule</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">hidden</span><span class="p">,</span> <span class="n">bn</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden</span> <span class="o">=</span> <span class="n">hidden</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bn</span> <span class="o">=</span> <span class="n">bn</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">ImgModel</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;_backend&#39;: &lt;torch.nn.backends.thnn.THNNFunctionBackend at 0x118f9a320&gt;,
 &#39;_parameters&#39;: OrderedDict(),
 &#39;_buffers&#39;: OrderedDict(),
 &#39;_backward_hooks&#39;: OrderedDict(),
 &#39;_forward_hooks&#39;: OrderedDict(),
 &#39;_forward_pre_hooks&#39;: OrderedDict(),
 &#39;_state_dict_hooks&#39;: OrderedDict(),
 &#39;_load_state_dict_pre_hooks&#39;: OrderedDict(),
 &#39;_modules&#39;: OrderedDict(),
 &#39;training&#39;: True,
 &#39;init_args&#39;: {&#39;dim&#39;: 12, &#39;hidden&#39;: 4, &#39;bn&#39;: True},
 &#39;dim&#39;: 12,
 &#39;hidden&#39;: 4,
 &#39;bn&#39;: True}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img2</span> <span class="o">=</span> <span class="n">ImgModel</span><span class="o">.</span><span class="n">from_list</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="n">img2</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;_backend&#39;: &lt;torch.nn.backends.thnn.THNNFunctionBackend at 0x118f9a320&gt;,
 &#39;_parameters&#39;: OrderedDict(),
 &#39;_buffers&#39;: OrderedDict(),
 &#39;_backward_hooks&#39;: OrderedDict(),
 &#39;_forward_hooks&#39;: OrderedDict(),
 &#39;_forward_pre_hooks&#39;: OrderedDict(),
 &#39;_state_dict_hooks&#39;: OrderedDict(),
 &#39;_load_state_dict_pre_hooks&#39;: OrderedDict(),
 &#39;_modules&#39;: OrderedDict(),
 &#39;training&#39;: True,
 &#39;init_args&#39;: {&#39;dim&#39;: 3, &#39;hidden&#39;: 6, &#39;bn&#39;: False},
 &#39;dim&#39;: 3,
 &#39;hidden&#39;: 6,
 &#39;bn&#39;: False}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img2</span><span class="o">.</span><span class="n">get_args</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>init args: {&#39;dim&#39;: 3, &#39;hidden&#39;: 6, &#39;bn&#39;: False}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-changing-BaseModel-to-mixin-(called-ModelMixin).-Ended-up-switching-back-bc-regular-inheritance-works-after-all-(not-sure-what-caused-prev-issue,-where-from_path-method-received-cls-basemodel-instead-of-child-model)">Testing changing BaseModel to mixin (called ModelMixin). Ended up switching back bc regular inheritance works after all (not sure what caused prev issue, where from_path method received cls basemodel instead of child model)<a class="anchor-link" href="#Testing-changing-BaseModel-to-mixin-(called-ModelMixin).-Ended-up-switching-back-bc-regular-inheritance-works-after-all-(not-sure-what-caused-prev-issue,-where-from_path-method-received-cls-basemodel-instead-of-child-model)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">htools.ml</span> <span class="k">import</span> <span class="n">ModelMixin</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="super-init-version-1:-probably-more-confusing,-use-version-2-below">super init version 1: probably more confusing, use version 2 below<a class="anchor-link" href="#super-init-version-1:-probably-more-confusing,-use-version-2-below">&#182;</a></h2><p>-nn.Module comes first here<br>
-still a bit confused about exactly how order and init statements work</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">ModelMixin</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">ModelMixin</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">locals</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">x_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0., 3., 0.],
        [4., 5., 4.],
        [4., 1., 0.],
        [1., 2., 3.]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">net</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Net(
  (fc): Linear(in_features=3, out_features=1, bias=True)
  (act): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.2570],
        [0.8122],
        [0.8215],
        [0.5569]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">dims</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(1, 3), (1,)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">trainable</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((1, 3), True), ((1,), True)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(0.178, 0.373), (-0.471, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">plot_weights</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAi8AAACsCAYAAACzb0wbAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAdtElEQVR4nO3debhcVZnv8e8PQhIVQoAEhEA42oAyiEED6JUAAi3gANgMzSAmTqjI5Tq15qrdzgioF64ttoYGJaDMKmFSBAyIEoEoBGOYDRAZI5yQkIAS3v5jraM7lapT+ySnqs6u8/s8Tz2naq+1d721dtXZb621dm1FBGZmZmZVsU6nAzAzMzMbCCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFhjVJ0yTd1Ok46pE0XtLdkka34blukbRjq5+nVSS9RdJPOx1HFUkaJekuSZt2Ohazspy8WNeTtIek30haIukpSb+WtGun4yphOvD9iHgOQNIR+XUslzR7IBuSdGROhJZIekLSOZLGFKp8A/hSP+uPlPRNSYskLZP0J0mnFcoXStpvAPH8QNJXBvIamjgJOLmw/R5Jv8xtdVd/sfXXrpKm5NdbvIWkQ3O5JH1F0p9z284eSBIoaZKkufm550qa1E/d8yQ9KukZSfdIen+h7JiaGJfnOF+fyz8q6YG87iOSTpM0AiAingfOBj5dNm6zTnPyYl0tH6CvAP4T2BiYAHwReL6TcTUjaRQwFTivsPgp4HQKB+kB+DXwpojYEHglMAIoJg+zgDdL2rzB+v8XmAzsBmwAvBn4/RrEMehyIrphRMwpLD6fFN8mwGeBSySNb7CJhu0aEb+KiPX7bsDbgWXAz3KVw4H3AlNI76+bgXNLxj0SuIy0jzcCzgEuy8vr+RrQExFjgIOAr/QlJxHxw5o4jwceAH6X170ceF1edyfgtcCJhW3/CJia33dmQ56TF+t22wFExPkRsTIiVkTENRExr1hJ0jckPZ17FA4sLH+PpAWSluZvrh8slO2deyI+I2lx7n04plA+Km/3IUmPS/qupJeUjHt3oDciFvUtiIhrI+Ii4JGBNkJEPBwRiwuLVgLbFMqfA+YCb2mwiV2Bn0TEI5EsjIiZAJLOBSYCl+dv/Z/Kyy+W9Fjukbixr0dC0nHAMcCncv3L8/JP5x6MpbmXaN+SL+9A4Ia+B5K2A14HfD7v70uBO4FDG7TNQNp1KnBJRDybH78CuCkiHoiIlaREZIeSce9NSiJPj4jnI+JbgIB9GsQ5P/eSAES+/VM/cc6M/BPqEXF/RPTmMgEvsur+XwQ8DbyhZOxmHeXkxbrdPcDKPExyoKSN6tTZHbgbGAecCpwlSbnsCdK37THAe4DTJL2usO7L83oTSAeMGZJelctOISVPk0gHignAf/StKKlX0h4N4n5NjmnQKA2fLQGWkg7kp9dUWUD6Rl7PHODjko6X9JpC+xARxwIPAe/I3/xPzUVXA9sCm5J6AH6Y68/I90/N9d+R2+wEYNeI2ADYH1hYiLvvwFtPbVvtCDwQEUsLy+7Iy9eYpJcCh5F6SPpcAGwjaTtJ65HeAz+rt34dOwLz+hKMbF5/cUr6jqTlwF3Ao8BVdepsDewJzKxZfrSkZ4DFpP38vZpV+9v/ZkOKkxfrahHxDLAH6VvqmcCTkmZJ2qxQ7cGIODN/cz4H2BzYLK9/Zf7WGhFxA3ANaYig6N/zN+cbgCuBI/LB/QPAxyLiqXwgPQk4shDb2IhoNFl4LCnJGDQRcVMeNtoS+Do5OShYmp+3nq+RkrFjgNuAP0ua2uT5zo6Ipbm34AvAayVt2KD6SmAUsIOk9XLPzv2FuBvFBau31frAkpo6S0jDXWvjUNKB/4bCskeBX5GSpxWkYaSPldzegOOMiONz+RTgx9Qf/nw38KuI+FPNuj/Kw0bbAd8FHq9Zr7/9bzakOHmxrhcRCyJiWkRsSRrv34JVex0eK9Rdnu+uD5B7a+YoTfTtBd5K6mnp83RhCAHgwbz98cBLgbm5h6WX9I280byLWk+z9gfbuiLizzmWC2qKNgDq9nDkIbczIuJNpAPcV4GzJW1fr76kdSWdLOn+/G1/YS4aV69+RNwHfJSU5Dwh6QJJW5R8SbVttYzUU1Y0hrVPBlcZisk+TxpS2woYTZpPdX3upWlmjeLM++ImUhL64TpV3s2qvUO1698LzAe+U1PUcP+bDTVOXmxYiYi7gB+Qkph+5cmLl5LOxNksf/u/ijRnoM9Gkl5WeDyRNHdiMemb+I65h2VsRGyYJ1OWMY88X6dFRrD6fIntScMr/crzSM4gJQ198ztqL09/NHAwsB+wIdCTl6tB/b6egT2ArXP5KU1fRVLbVvOBV0oqJjSvzcvXiKStSHNUZtYUvRa4MCIWRcQLEfED0uTbMvNe5gM7F4fggJ0HEOdq+1DSm0jJ8yUDXZeS+99sKHDyYl1N0qslfULSlvnxVsBRpDkczYwkDWU8CbyQJ/LWm9D6RaVTiaeQ5sdcHBEvkoapTlP+/QxJEyTtXzL0W4CxkiYUXsu6Sr/5MgJYR9LoPM+ir3yhpGn1NqZ0Ku1EJVuTek6uK5SPAl4P/KLB+h/NE5RfImlEHjLagH+ccfQ46SymPhuQhjT+QuqBOqlmk6vUl/QqSfvkOJ4jJX4rGzVOjauAvfoeRMQ9wO3A53MbvZOUFFza4LX1267ZscBv+oayCm4FDpe0maR1JB0LrAfcl7f9BTU+rX12fo0n5sndJ+Tl19eJcVOl093Xz/HuT3of19adClxaM98HSe8vvA93IJ09Vtz/E0hnS5X5XJh1XkT45lvX3kiTZC8C/gw8m/9+DxiTy6eRzhYprhPANvn+R0gH2l7SKbAXAF/JZXsDi0in4i4mTVo9trCd0aSD9gPAM6QJkScWypcBU/qJ/evApwuPp/GPs0z6bj/IZSNJww2vbrCtr+ZYn81/ZwCbFMoPB37cTywfJJ2NtCS3xS3A2wvlB+fX3wt8kjTsdlmO6UHSUEaxXbclJRi9wE9JycUtuf5TpNPbt8h1pwDLmuznW4HdC497SMnBCtJ8lP0KZccA88u0a6HOXcD76jzvaOAM0tyXZ0gTkw8olJ8FfLWfuHfJ7boir7tLoewzwNX5/njSXJve/Dx3Ah+oE0svsG+d5/k+6X38LGkI7+vA6EL5vwH/r9OfV998K3tTxGq9t2ZWgqS9gfMizaVpxfbHkyaD7hIRK5rU3QP4SEQctYbP9VvSwfkPa7J+p0l6C3B8RBzS6ViKJN1OSib+0ulYGsm9XXcAe0bEE52Ox6wMJy9ma6jVyYuZmdXnOS9mZmZWKe55MTMzs0pp2vMi6WylC7lVcizczMzMukvTnhdJe5LOipgZEU1/GwNg3Lhx0dPTs/bRmZmZ2bA0d+7cxRFR94c9RzRbOSJulNQzkCfs6enhtttuG8gqZmZmZn8n6cFGZU2TlwE8yXHAcQATJ04crM3W1TP9ypZuv9UWnvy2Todg1lFV/wyDP8e29qr+OejkZ2DQzjaKiBkRMTkiJo8fX/byLWZmZmYD41OlzczMrFKcvJiZmVmllDlV+nzgZuBVkhZJel/rwzIzMzOrr8zZRmt0rRQzMzOzVvCwkZmZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0oplbxIOkDS3ZLukzS91UGZmZmZNdI0eZG0LnAGcCCwA3CUpB1aHZiZmZlZPWV6XnYD7ouIByLir8AFwMGtDcvMzMysvhEl6kwAHi48XgTsXltJ0nHAcfnhMkl3r314qxkHLG7BdttKp6zV6l3RBmthuL9+cBvAEGiDtfwcD4aOt8EQ4DboYBu04TOwdaOCMsmL6iyL1RZEzABmDCCoAZN0W0RMbuVzDHXDvQ2G++sHtwG4DcBtAG4DGL5tUGbYaBGwVeHxlsAjrQnHzMzMrH9lkpdbgW0lvULSSOBIYFZrwzIzMzOrr+mwUUS8IOkE4OfAusDZETG/5ZHV19JhqYoY7m0w3F8/uA3AbQBuA3AbwDBtA0WsNn3FzMzMbMjyL+yamZlZpTh5MTMzs0oZ0smLpI0l/ULSvfnvRnXqTJJ0s6T5kuZJ+tdOxNoqZdog1/uZpF5JV7Q7xlZodkkKSaMkXZjLfyupp/1RtlaJNthT0u8kvSDpsE7E2Gol2uDjkv6YP/vXSWr4uxBVVaINPiTpTkm3S7qp234BvezlaSQdJikkdd1pwyXeA9MkPZnfA7dLen8n4myriBiyN+BUYHq+Px04pU6d7YBt8/0tgEeBsZ2OvZ1tkMv2Bd4BXNHpmAfhNa8L3A+8EhgJ3AHsUFPneOC7+f6RwIWdjrsDbdAD7AzMBA7rdMwdaoM3Ay/N9z88TN8HYwr3DwJ+1um42/n6c70NgBuBOcDkTsfdgffANODbnY61nbch3fNCugzBOfn+OcAhtRUi4p6IuDfffwR4Ahjftghbr2kbAETEdcDSdgXVYmUuSVFsl0uAfSXV+0HFqmraBhGxMCLmAS92IsA2KNMGv4yI5fnhHNLvUHWTMm3wTOHhy6jzI6IVVvbyNF8mfdF7rp3BtYkv0VPHUE9eNouIRwHy3037qyxpN1Jmen8bYmuXAbVBl6h3SYoJjepExAvAEmCTtkTXHmXaoNsNtA3eB1zd0ojar1QbSPqIpPtJB/AT2xRbOzR9/ZJ2AbaKiK4YMq+j7Ofg0Dx8eomkreqUd5UylwdoKUnXAi+vU/TZAW5nc+BcYGpEVOqb6GC1QRcpc0mKUpetqLBuf31llG4DSe8CJgN7tTSi9it7eZYzgDMkHQ18Dpja6sDapN/XL2kd4DTSsEm3KvMeuBw4PyKel/QhUq/0Pi2PrIM6nrxExH6NyiQ9LmnziHg0JydPNKg3BrgS+FxEzGlRqC0zGG3QZcpckqKvziJJI4ANgafaE15b+LIcJdtA0n6kRH+viHi+TbG1y0DfBxcA/9XSiNqr2evfANgJmJ1HjV8OzJJ0UETc1rYoW6vpeyAi/lJ4eCbQ+cuGtthQHzaaxT++QUwFLqutkC9Z8BNgZkRc3MbY2qVpG3ShMpekKLbLYcD1kWeudQlflqNEG+Qhg+8BB0VENyb2Zdpg28LDtwH3tjG+Vuv39UfEkogYFxE9EdFDmvfUTYkLlHsPbF54eBCwoI3xdUanZwz3dyPNYbiO9GG8Dtg4L58M/He+/y7gb8DthdukTsfezjbIj38FPAmsIGXq+3c69rV83W8F7iHNX/psXvYl0j8mgNHAxcB9wC3AKzsdcwfaYNe8r58F/gLM73TMHWiDa4HHC5/9WZ2OuQNt8P+B+fn1/xLYsdMxt/P119SdTZedbVTyPfC1/B64I78HXt3pmFt98+UBzMzMrFKG+rCRmZmZ2SqcvJiZmVmlOHkxMzOzSnHyYmZmZpXi5MXMzMwqxcmLmZmZVYqTFzMzM6sUJy9mZmZWKU5ezMzMrFKcvJiZmVmlOHkxMzOzSnHyYmZmZpXi5MWsCUnTJN3U6TjqkTRe0t2SRq/BugdJuqAVcbWLpF9L2qXTcQxVkn4s6YBOx2E22Jy8mAGS9pD0G0lLJD2VD4q7djquEqYD34+I5wAkHZFfx3JJs/tbMSJmATtJ2rlRnf7aZaBJnaQeSSFpRNl1mmzvHcDSiPh9P3UmSZqb22OupEkltrutpOcknVdY9hlJywq3FZJelDQul5du9zY7Gfhqp4MwG2xOXmzYkzQGuAL4T2BjYALwReD5TsbVjKRRwFTgvMLip4DTSQetMs4Hjmuw/aHeLh8Czm1UKGkkcBmpfTYCzgEuy8v7cwZwa3FBRJwUEev33YBTgNkRsThXGWi7t0VE3AKMkTS507GYDSYnL2awHUBEnB8RKyNiRURcExHzipUkfUPS05L+JOnAwvL3SFogaamkByR9sFC2t6RF+Zv7YkkLJR1TKB+Vt/uQpMclfVfSS0rGvTvQGxGL+hZExLURcRHwSMltzAbe1qCsYbtI2h74LvDG3BPRm1/P2yT9XtIzkh6W9IXC9m7Mf3vzOm+UtI2kG3LPzmJJF5YJOicg+wA39FNtb2AEcHpEPB8R3wKU12u03SOBXuC6fuoIOJaUDAFr1O7F7X1B0kWSZub30PxisiFpuqT7c9kfJb2zUDZN0k2N3pvZbBrvY7NKcvJiBvcAKyWdI+lASRvVqbM7cDcwDjgVOCsfxACeAN4OjAHeA5wm6XWFdV+e15tA6imZIelVuewUUpIwCdgm1/mPvhUl9Urao0Hcr8kxrY0FQE/uZanVsF0iYgGp5+Pm3BsxNhc9C7wbGEs6YH5Y0iG5bM/8d2xe52bgy8A1pJ6RLUm9PABIukLS9AZxbwu8WEzc6tgRmBcRUVg2Ly9fTW6DLwGf6GebAFOAzYBLm9QbiIOAC0jtNgv4dqHs/vycG5J6vs6TtHmhvL/3JqR9/NpBjNWs45y82LAXEc8AewABnAk8KWmWpM0K1R6MiDMjYiXpG/fmpAMYEXFlRNwfyQ2kg/GUmqf59/zt/wbgSuCIfID5APCxiHgqIpYCJwFHFmIbGxGN5pWMBZau5cvvW39sbUHJdqldZ3ZE3BkRL+aeq/OBvfp5/r8BWwNbRMRzxdcaEW+PiEbDMGVe+/rAkpplS4ANGtT/MnBWRDzcZLtTgUsiYlmTegNxU0Rcld9f51JINiLi4oh4JLfphcC9wG6FdRu+N7Ol1Nm/ZlXm5MWM1JMQEdMiYktgJ2AL0hyGPo8V6i7Pd9cHyL0Sc/KE1l7graRvwX2ejohnC48fzNsfD7wUmJt7WHqBn+XlZTxN4wNxWX3r99YrLNEuq5C0u6RfSnpS0hJS78y4RvWBT5GGcm7JwyXvLRn3aq+9ZkLtRGAZqTesaAx1kp48kXc/4LT+njQP6R1OYchokDxWuL8cGK08sVnSuyXdXniP7MSqbdrwvZltQIP9a1ZVTl7MakTEXcAPSAeJfuVJs5cC3wA2y8MnV5EOyH02kvSywuOJpLkRi4EVwI65h2VsRGyYJ4SWMY88L2UtbA8szL0s/arTLlGn2o9Iwx5bRcSGpHkxalQ/Ih6LiA9ExBbAB4HvSNqmRNz3kqafTChsa/3C7SFgPrBzzRDKznl5rb2BHuAhSY8BnwQOlfS7mnr/QpqcO7tEjGtN0takXq8TgE3y++sPrPr+amZ74I4WhGfWMU5ebNiT9GpJn5C0ZX68FXAUMKfE6iOBUcCTwAt5suRb6tT7oqSRkqaQ5sdcHBEvkg5Mp0naND/3BEn7lwz9FmBs8QAuaV2l33wZAawjabSk9QrlCyVNK2xjL+Dqehsv0S6PA1tq1bN3NgCeiojnJO0GHF0oexJ4EXhl4TkO79s+qTclgJXNXnhE/A24lv6HpGbnbZ2oNDH6hLz8+jp1ZwD/RJp7NImUdF0J1O6LqcDMmnk0a9LuZb2M1CZP5u28hxJJdY2G+9isqpy8mKVhhN2B30p6lnRw/gPNJ26S56mcCFxEOvgeTep5KHoslz0C/BD4UO7FAPg0cB8wR9IzpANy32TevqGQ2vkzfc/9V1JPyLsKi48l9eb8F2nezQpSgtR3hs4mrJqUHQV8r8HLa9Yu15N6MR6T1HfK8PHAlyQtJU08vqgQ73LSb478Og+BvAHYNW9/Gand/k9E/CnHe7WkzzSIjRz3sY0Kc/scQppA3Au8FzgkL+/77Zar+2LLvUCPRcRjpCGn5yLiyb7t5SRxH2BmnacbaLuXEhF/BL4J3ExKFl8D/Lrs+kq/yfNsPmXarGuo5guEmQ0iSXsD5+U5I63Y/njgV8AuEbGiSd09gI9ExFH58TuAYyPiiFbE1g5KP5L3v/v7obpOq233Nj/3paRJyFe1+7nNWsnJi1kLtTp5MTMbjjxsZGZmZpXinhczMzOrlKY9L5LOlvSEpD+0IyAzMzOz/jTteZG0J2nm/cyIKHWK3rhx46Knp2ftozMzM7Nhae7cuYsjou6Pdja9NH1E3CipZyBP2NPTw2233TaQVczMzMz+TtKDjcqaJi8DeJLjgOMAJk6cOFibNbMu1DP9yk6HsNYWnuwLNZt1yqCdbRQRMyJickRMHj++7KVZzMzMzAbGp0qbmZlZpTh5MTMzs0opc6r0+aTrarxK0iJJ72t9WGZmZmb1lTnbqO3X4zAzMzNrxMNGZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrFCcvZmZmVilOXszMzKxSnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKqVU8iLpAEl3S7pP0vRWB2VmZmbWSNPkRdK6wBnAgcAOwFGSdmh1YGZmZmb1lOl52Q24LyIeiIi/AhcAB7c2LDMzM7P6RpSoMwF4uPB4EbB7bSVJxwHH5YfLJN1dYtvjgMUl6llruP07z/ugs9a4/XXKIEcyfPkz0HlDdR9s3aigTPKiOstitQURM4AZAwgKSbdFxOSBrGODx+3fed4HneX27zzvg86r4j4oM2y0CNiq8HhL4JHWhGNmZmbWvzLJy63AtpJeIWkkcCQwq7VhmZmZmdXXdNgoIl6QdALwc2Bd4OyImD9Izz+gYSYbdG7/zvM+6Cy3f+d5H3Re5faBIlabvmJmZmY2ZPkXds3MzKxSnLyYmZlZpbQ1eZF0uKT5kl6U1PC0LF+OoDUkbSzpF5LuzX83alDv1LyfFkj6lqR6p8vbGhjAPpgo6Zq8D/4oqae9kXansu2f646R9GdJ325njN2uzD6QNEnSzfn/0DxJ/9qJWLtJs+OqpFGSLszlvx3q/3Pa3fPyB+BfgBsbVfDlCFpqOnBdRGwLXJcfr0LS/wLeBOwM7ATsCuzVziC7XNN9kM0Evh4R25N+5fqJNsXX7cq2P8CXgRvaEtXwUmYfLAfeHRE7AgcAp0sa28YYu0rJ4+r7gKcjYhvgNGBI/wxjW5OXiFgQEc1+edeXI2idg4Fz8v1zgEPq1AlgNDASGAWsBzzeluiGh6b7IP9TGRERvwCIiGURsbx9IXa1Mp8BJL0e2Ay4pk1xDSdN90FE3BMR9+b7j5CS9/Fti7D7lDmuFvfLJcC+Q7nXfSjOeal3OYIJHYql22wWEY8C5L+b1laIiJuBXwKP5tvPI2JBW6Psbk33AbAd0Cvpx5J+L+nr+ZuTrb2m7S9pHeCbwL+1Obbhosxn4O8k7Ub6MnV/G2LrVmWOq3+vExEvAEuATdoS3Rooc3mAAZF0LfDyOkWfjYjLymyizjKfz11Sf+1fcv1tgO1Jv6QM8AtJe0ZEw6E+W9Xa7gPS53IKsAvwEHAhMA04azDi63aD0P7HA1dFxMND+IvnkDYI+6BvO5sD5wJTI+LFwYhtmCpzXK3UsXfQk5eI2G8tN+HLEayF/tpf0uOSNo+IR/M/hXrzKN4JzImIZXmdq4E30M88JVvVIOyDRcDvI+KBvM5PSfvAyUsJg9D+bwSmSDoeWB8YKWlZRPjkgZIGYR8gaQxwJfC5iJjTolCHizLH1b46iySNADYEnmpPeAM3FIeNfDmC1pkFTM33pwL1esIeAvaSNELSeqTJuh42Gjxl9sGtwEaS+sb49wH+2IbYhoOm7R8Rx0TExIjoAT4JzHTiMqia7oP8v/8npLa/uI2xdasyx9XifjkMuD6G8K/YtvtU6XdKWkT6ZnOlpJ/n5VtIugr+PtbWdzmCBcBFg3g5guHuZOCfJd0L/HN+jKTJkv4717mENLZ8J3AHcEdEXN6JYLtU030QEStJB83rJN1J6s49s0PxdpsynwFrrTL74AhgT2CapNvzbVJnwq2+RsdVSV+SdFCudhawiaT7gI/T/5l4HefLA5iZmVmlDMVhIzMzM7OGnLyYmZlZpTh5MTMzs0px8mJmZmaV4uTFzMzMKsXJi5mZmVWKkxczMzOrlP8Bu2Cs6XqLgYAAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Weights saved from epoch 12.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span> <span class="o">=</span> <span class="n">Net</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s1">&#39;../data/model_12.pth&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 12 weights loaded from ../data/model_12.pth.
Model parameters: {&#39;x_dim&#39;: 3}
Currently in eval mode.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Net(
  (fc): Linear(in_features=3, out_features=1, bias=True)
  (act): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.2570],
        [0.8122],
        [0.8215],
        [0.5569]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Version-2---simpler-way-to-super-init">Version 2 - simpler way to super init<a class="anchor-link" href="#Version-2---simpler-way-to-super-init">&#182;</a></h2><p>-ModelMixin must come before nn.Module<br>
-locals() must be passed to super init so mixin can store args</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">NetB</span><span class="p">(</span><span class="n">ModelMixin</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">x_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">act</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb</span> <span class="o">=</span> <span class="n">NetB</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">netb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>NetB(
  (fc): Linear(in_features=3, out_features=1, bias=True)
  (act): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4054],
        [0.1432],
        [0.1389],
        [0.4869]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb</span><span class="o">.</span><span class="n">trainable</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[((1, 3), True), ((1,), True)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb</span><span class="o">.</span><span class="n">dims</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(1, 3), (1,)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Weights saved from epoch 4.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb2</span> <span class="o">=</span> <span class="n">NetB</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s1">&#39;../data/model_4.pth&#39;</span><span class="p">)</span>
<span class="n">netb2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 4 weights loaded from ../data/model_4.pth.
Model parameters: {&#39;x_dim&#39;: 3}
Currently in eval mode.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>NetB(
  (fc): Linear(in_features=3, out_features=1, bias=True)
  (act): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">netb2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4054],
        [0.1432],
        [0.1389],
        [0.4869]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;../data/model_4.pth&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;weights&#39;, &#39;epoch&#39;, &#39;params&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Testing-inheritance-again-(non-mixin)">Testing inheritance again (non mixin)<a class="anchor-link" href="#Testing-inheritance-again-(non-mixin)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="kn">from</span> <span class="nn">ml_htools.torch_utils</span> <span class="k">import</span> <span class="n">BaseModel</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
            <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">())</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[5., 3., 1., 3., 4.],
        [5., 2., 5., 1., 1.],
        [0., 1., 2., 0., 1.]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">SubModel</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SubModel(
  (layers): Sequential(
    (0): Linear(in_features=5, out_features=1, bias=True)
    (1): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Sigmoid()
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(-0.017, 0.101), (-0.348, nan), (1.0, nan), (0.0, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4756],
        [0.7806],
        [0.2366]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1 weights saved to ../data/model_e1.pth.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">FileExistsError</span>                           Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-17-c681115a8506&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>m<span class="ansi-blue-fg">.</span>save<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;../data&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/pythonhm/ml_htools/ml_htools/torch_utils.py</span> in <span class="ansi-cyan-fg">save</span><span class="ansi-blue-fg">(self, epoch, dir_, file, overwrite, verbose, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>         path <span class="ansi-blue-fg">=</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>weight_dir<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">f&#39;{file}_e{epoch}.pth&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     94</span>         <span class="ansi-green-fg">if</span> os<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">.</span>exists<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> overwrite<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 95</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> FileExistsError
<span class="ansi-green-intense-fg ansi-bold">     96</span> 
<span class="ansi-green-intense-fg ansi-bold">     97</span>         data = dict(weights=self.state_dict(),

<span class="ansi-red-fg">FileExistsError</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">penalty</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">penalty</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor([[ 0.0804,  0.0819, -0.0600, -0.1556, -0.0313]])
tensor([[ 0.1015,  0.1286, -0.2173, -0.0664,  0.0962]]) 

tensor([-0.3481])
tensor([-0.3481]) 

tensor([1.])
tensor([-0.0752]) 

tensor([0.])
tensor([0.0381]) 

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(0.009, 0.148), (-0.348, nan), (-0.075, nan), (0.038, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4830],
        [0.5242],
        [0.5213]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">weight_dir</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;../data&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 2 weights saved to ../data/model_e2.pth.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">SubModel</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s1">&#39;../data/model_e1.pth&#39;</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1 weights loaded from ../data/model_e1.pth.
Model parameters: {&#39;dim&#39;: 5, &#39;norm&#39;: True}
Currently in eval mode.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SubModel(
  (layers): Sequential(
    (0): Linear(in_features=5, out_features=1, bias=True)
    (1): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Sigmoid()
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4756],
        [0.7806],
        [0.2366]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m1</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(-0.017, 0.101), (-0.348, nan), (1.0, nan), (0.0, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">load_epoch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 2 weights loaded from ../data/model_e2.pth. 
Model parameters: {&#39;dim&#39;: 5, &#39;norm&#39;: True}
Currently in train mode.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(0.009, 0.148), (-0.348, nan), (-0.075, nan), (0.038, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4830],
        [0.5242],
        [0.5213]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="o">.</span><span class="n">load_epoch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">weight_stats</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1 weights loaded from ../data/model_e1.pth. 
Model parameters: {&#39;dim&#39;: 5, &#39;norm&#39;: True}
Currently in train mode.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(-0.017, 0.101), (-0.348, nan), (1.0, nan), (0.0, nan)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">m</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0.4756],
        [0.7806],
        [0.2366]], grad_fn=&lt;SigmoidBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Scratch---load_epoch()">Scratch - load_epoch()<a class="anchor-link" href="#Scratch---load_epoch()">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;_e</span><span class="si">{num}</span><span class="s1">.pth&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;model_e2.pth&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;.*_e</span><span class="si">{1}</span><span class="s1">.pth&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;model_e1.pth&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;../data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;lines5000.txt&#39;, &#39;model_e1.pth&#39;, &#39;model_e2.pth&#39;, &#39;lines100.txt&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

